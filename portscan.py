#!/usr/bin/env python

import sys
import socket
import time

if len(sys.argv) <= 2:
	print '\r\nModo de uso: ./portscan.py ip timer \r\nEXEMPLO: ./portscan.py 192.168.0.1 0 \r\n'
else:
	ip = sys.argv[1]
	msg = "GET / HTTP/1.0\r\n\r\n"
	timer = float(sys.argv[2])
	banner = ''

	print "*" * 80 
	print "                         SCAN NO HOST ------>", ip
	print "*" * 80

	try:
		for porta in xrange(1, 65535):
			time.sleep(timer)
			s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
			r = s.connect_ex((ip,porta))
			if (r == 0):
				print '\r\nPORTA:',porta,'SERVICO ON ---------> BANNER GRABBING...\r\n'
				s.send(msg)
				banner = s.recv(190)
				print banner
				s.close()

	except KeyboardInterrupt:
		print "Parando a varredura"
		sys.exit()
	except socket.error:
		print "Digite um HOST valido"
		sys.exit()
